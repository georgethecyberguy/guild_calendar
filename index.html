<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guild Calendar 2025</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #000; color: #fff; padding: 20px; }
    h1 { text-align: center; color: #fff; }
    .controls { text-align: center; margin: 10px 0; }
    select, .time-input { background-color: #000; color: #fff; border: 1px solid #333; padding: 5px; font-size: 14px; }
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background-color: #000; margin-top: 10px; }
    .day-header { background-color: #111; text-align: center; padding: 8px; font-weight: bold; color: #fff; }
    .day-cell { background-color: #000; border: 1px solid #333; display: flex; flex-direction: column; align-items: flex-start; padding: 6px; color: #fff; aspect-ratio: 1 / 1; overflow: hidden; }
    .day-number { font-weight: bold; width: 100%; margin-bottom: 4px; }
    .entry-count { width: 100%; text-align: center; font-size: 13px; margin-bottom: 4px; color: #ffcc00; }
    .entries { flex: 1; display: flex; flex-direction: column; width: 100%; overflow-y: auto; }
    .entry { display: flex; align-items: center; gap: 4px; margin-top: 2px; width: 100%; }
    .time-input { width: 80px; }
    .entry select, .entry input[type="text"] { background-color: #000; color: #fff; border: 1px solid #333; padding: 2px 4px; font-size: 12px; }
    .entry input[type="text"] { flex: 1; }
    #exportBtn { display: block; margin: 15px auto; padding: 8px 16px; font-size: 14px; background-color: #111; color: #fff; border: none; cursor: pointer; }
    #exportBtn:hover { background-color: #333; }
  </style>
</head>
<body>
  <h1>Guild Calendar 2025</h1>
  <div class="controls">
    <select id="monthSelect">
      <option value="0">January 2025</option>
      <option value="1">February 2025</option>
      <option value="2">March 2025</option>
      <option value="3">April 2025</option>
      <option value="4">May 2025</option>
      <option value="5">June 2025</option>
      <option value="6" selected>July 2025</option>
      <option value="7">August 2025</option>
      <option value="8">September 2025</option>
      <option value="9">October 2025</option>
      <option value="10">November 2025</option>
      <option value="11">December 2025</option>
    </select>
  </div>
  <div id="calendar" class="calendar"></div>
  <button id="exportBtn">Export Calendar</button>
  <script>
    const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    const classOptions = [
      { label:'Druid', value:'üêâ' },{ label:'Mage', value:'üî•' },{ label:'Warrior', value:'üõ°Ô∏è' },
      { label:'Hunter', value:'üèπ' },{ label:'Priest', value:'üôè' },{ label:'Rogue', value:'ü•∑' },
      { label:'Warlock', value:'ü™Ñ' },{ label:'Shaman', value:'üå©Ô∏è' },{ label:'Paladin', value:'üõê' },
      { label:'Monk', value:'üßò' },{ label:'Death Knight', value:'‚ò†Ô∏è' },{ label:'Demon Hunter', value:'üëø' },
      { label:'Evoker', value:'üßë‚Äçüíª' }
    ];
    const year = 2025;
    const calendarEl = document.getElementById('calendar');

    function createEntry() {
      const entry = document.createElement('div'); entry.className='entry';
      const timeSelect = document.createElement('select'); timeSelect.className='time-input';
      for(let i=0;i<24;i++){ const opt=document.createElement('option'); const h12=i%12===0?12:i%12; const ampm=i<12?'AM':'PM'; const label=h12+':00 '+ampm; opt.value=label; opt.textContent=label; timeSelect.appendChild(opt);} entry.appendChild(timeSelect);
      const select=document.createElement('select'); const blank=document.createElement('option'); blank.value=''; blank.textContent='-'; select.appendChild(blank);
      classOptions.forEach(opt=>{ const o=document.createElement('option'); o.value=opt.value; o.textContent=opt.value; o.title=opt.label; select.appendChild(o); }); entry.appendChild(select);
      const input=document.createElement('input'); input.type='text'; input.placeholder='Name'; entry.appendChild(input);
      return entry;
    }

    function renderCalendar(monthIndex) {
      calendarEl.innerHTML='';
      ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'].forEach(d=>{ const hd=document.createElement('div'); hd.className='day-header'; hd.textContent=d; calendarEl.appendChild(hd); });
      const firstDay=new Date(year,monthIndex,1).getDay();
      const daysInMonth=new Date(year,monthIndex+1,0).getDate();
      const totalCells=35;
      for(let i=0;i<firstDay;i++){ const empty=document.createElement('div'); empty.className='day-cell'; calendarEl.appendChild(empty); }
      for(let day=1;day<=daysInMonth;day++){
        const cell=document.createElement('div'); cell.className='day-cell';
        const num=document.createElement('div'); num.className='day-number'; num.textContent=day;
        const count=document.createElement('div'); count.className='entry-count'; count.style.display='none';
        const entriesWrap=document.createElement('div'); entriesWrap.className='entries';
        for(let i=0;i<30;i++) entriesWrap.appendChild(createEntry());
        cell.appendChild(num); cell.appendChild(count); cell.appendChild(entriesWrap); calendarEl.appendChild(cell);
      }
      const current=calendarEl.querySelectorAll('.day-cell').length;
      for(let i=current;i<totalCells;i++){ const extra=document.createElement('div'); extra.className='day-cell'; calendarEl.appendChild(extra); }
      updateEntries();
    }

    function updateEntries(){
      document.querySelectorAll('.day-cell').forEach(cell=>{
        const entries=cell.querySelectorAll('.entry'); let signed=0;
        entries.forEach(ent=>{ if(ent.querySelector('input[type="text"]').value.trim()) signed++; });
        const bubble=cell.querySelector('.entry-count');
        if(bubble){ if(signed>0){ bubble.textContent=`${signed} signed up`; bubble.style.display='block'; } else bubble.style.display='none'; }
        entries.forEach((ent,idx)=> ent.style.display=idx<=signed?'flex':'none');
      });
    }

    document.getElementById('monthSelect').addEventListener('change', e=> renderCalendar(parseInt(e.target.value)));
    calendarEl.addEventListener('input', updateEntries);
    calendarEl.addEventListener('change', updateEntries);
    document.getElementById('exportBtn').addEventListener('click', ()=>{
      let csv=''; document.querySelectorAll('.day-cell').forEach(cell=>{
        const dayEl=cell.querySelector('.day-number'); csv+=dayEl?`Day ${dayEl.textContent},`:'Empty,';
        cell.querySelectorAll('.entry').forEach(ent=>{ const time=ent.querySelector('.time-input').value; const cls=ent.querySelector('select').value; const nm=ent.querySelector('input[type="text"]').value; csv+=(time+' '+cls+' '+nm).trim()+','; }); csv+='\n';
      });
      const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const link=document.createElement('a'); link.href=URL.createObjectURL(blob);
      const m=parseInt(document.getElementById('monthSelect').value);
      link.download=`guild_${monthNames[m]}2025.csv`;
      link.click();
    });

    renderCalendar(parseInt(document.getElementById('monthSelect').value));
  </script>
</body>
</html>
